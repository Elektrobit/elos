<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="../_static/favicon_16x16.png" sizes="16x11" rel="icon" type="image/png">
    <link href="../_static/favicon_32x32.png" sizes="32x21" rel="icon" type="image/png">
    <title>elos &#8212; elos  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Demos" href="../src/demos/index.html" />
    <link rel="prev" title="Welcome to elos’s documentation!" href="../index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="elos">
<h1>elos<a class="headerlink" href="#elos" title="Link to this heading">¶</a></h1>
<section id="short-overview">
<h2>Short Overview<a class="headerlink" href="#short-overview" title="Link to this heading">¶</a></h2>
<p>The name “elos” means “event logging and management system” and describes a tool to collect, store and publish various system
information (i.e. syslogs, core dumps, measurements obtained from proc- and sys-fs, …) while providing easy
access to the collected data for other programs and network clients.</p>
<p>To reach this goal, elos is using a so called canonical format, which means, that every collected data will
be provided in a normalized form, so all of the data from different sources gets structured and can be obtained
in the same way.</p>
<p><img alt="Elos Layout" src="../_images/elos_layout.png" /></p>
</section>
<hr class="docutils" />
<section id="events">
<h2>Events<a class="headerlink" href="#events" title="Link to this heading">¶</a></h2>
<p>Elos uses events to communicate. Events can be exchanged over the network, so different clients may get them,
or they can get logged on the elosd server (to use the information later on). An event is structured in a “canonical
form”, so an event does always contain the attributes: date, source, severity, hardware id, message code,
classification and payload.</p>
<p>The payload might be considered the most interesting part, since the original information gathered from
the system is stored there. However, the other metadata of the event might be of help too, for example, if
only certain events (lets say stored events from a certain date and time, that occurred at a specific hardware)
shall be examined, while all other events shouldn’t get displayed.</p>
<p>The meaning of the different attributes is listed below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">date</span><span class="p">:</span> <span class="n">unix</span> <span class="n">timestamp</span> <span class="ow">in</span> <span class="n">seconds</span> <span class="ow">and</span> <span class="n">nano</span> <span class="n">seconds</span><span class="p">,</span> <span class="n">the</span> <span class="n">actual</span> <span class="n">date</span> <span class="n">of</span> <span class="n">the</span> <span class="n">event</span> <span class="n">can</span> <span class="n">be</span> <span class="n">reconstructed</span> <span class="kn">from</span> <span class="nn">it</span>
<span class="o">*</span> <span class="n">source</span><span class="p">:</span> <span class="n">the</span> <span class="n">origin</span><span class="o">/</span><span class="n">software</span> <span class="n">that</span> <span class="n">created</span> <span class="n">the</span> <span class="n">particular</span> <span class="n">information</span>
<span class="o">*</span> <span class="n">severity</span><span class="p">:</span> <span class="n">when</span> <span class="n">the</span> <span class="n">message</span> <span class="n">gets</span> <span class="n">classified</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">mapped</span> <span class="n">to</span> <span class="n">a</span> <span class="n">severity</span> <span class="n">value</span> <span class="n">defined</span> <span class="n">by</span> <span class="n">this</span> <span class="n">project</span>
<span class="o">*</span> <span class="n">hardware</span> <span class="nb">id</span><span class="p">:</span> <span class="n">unique</span> <span class="n">identifier</span> <span class="n">of</span> <span class="n">the</span> <span class="n">hardware</span> <span class="n">that</span> <span class="n">produced</span> <span class="n">the</span> <span class="n">particular</span> <span class="n">information</span>
<span class="o">*</span> <span class="n">message</span> <span class="n">code</span><span class="p">:</span> <span class="n">hides</span> <span class="n">information</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">security</span> <span class="n">perspective</span><span class="p">),</span> <span class="n">thus</span> <span class="n">an</span> <span class="n">information</span> <span class="n">has</span> <span class="n">a</span> <span class="n">meaning</span> <span class="n">without</span> <span class="n">providing</span> <span class="n">a</span> <span class="n">payload</span>
<span class="o">*</span> <span class="n">classification</span><span class="p">:</span> <span class="n">a</span> <span class="nb">set</span> <span class="n">of</span> <span class="n">flags</span> <span class="n">to</span> <span class="n">categorize</span> <span class="n">events</span>
<span class="o">*</span> <span class="n">payload</span><span class="p">:</span> <span class="n">the</span> <span class="n">actual</span> <span class="n">payload</span> <span class="n">of</span> <span class="n">the</span> <span class="n">information</span> <span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">structs</span><span class="p">)</span>
</pre></div>
</div>
<p>Note: To calculate the date from seconds and nanoseconds you can use the shell command:
<code class="docutils literal notranslate"><span class="pre">date</span> <span class="pre">-d&#64;&lt;seconds&gt;.&lt;nanoseconds&gt;</span> <span class="pre">+%Y-%m-%d-%H:%M:%S.%N</span></code></p>
</section>
<hr class="docutils" />
<section id="logging">
<h2>Logging<a class="headerlink" href="#logging" title="Link to this heading">¶</a></h2>
<p>Events can actually get stored in a json formatted log file, containing the information of the events described
above. This file is also considered the “json backend”, since it is a database. The upper limit of the storage size
will be 100GB. The event logging is done separately by each event source, while not all events are automatically
logged. elos provides a server component named “EventProcessor” or “elosd” (elos daemon) containing a so
called “LogAggregator” to manage the retention police of the logging backend.</p>
<p>Here is an example how the json data of a stored event could look like:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;date&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1667929310</span><span class="p">,</span><span class="mi">941892533</span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;source&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;appname&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;openssh&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;filename&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/usr/bin/sshd&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;pid&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">208</span><span class="p">,</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;severity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;hardwareid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;817d6b97-75f8-4faf-ba3c-583ae1123558&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;classification&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;messageCode&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8004</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;failed to login user xy&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The value for <code class="docutils literal notranslate"><span class="pre">classification</span></code> is a concatenation of the flags <code class="docutils literal notranslate"><span class="pre">Network|Security</span></code>.</p>
</section>
<hr class="docutils" />
<section id="communication">
<h2>Communication<a class="headerlink" href="#communication" title="Link to this heading">¶</a></h2>
<p>The EventProcessor (or elosd server) works as a message broker, which receives and distributes events based on
previously defined event filters. The event communication is realized in a publish-poll pattern:
Clients interested in certain events will create an event filter on the server, which collects incoming matching
events in an event queue. A filter can relate to one or more members of an event. For example only events from a specific
aplication or with a specific severity could be collected. Listening clients must keep up the connection to the server, so
their filter and queues will exist further. When an event gets published by a client and doesn’t match any existing filters,
it will be dropped. Otherwise it will reside inside matching event queues, until it is read or overwritten by
newer events. When listening clients want to get updated about their queues, they will need to actively
read / poll from the server.</p>
</section>
<hr class="docutils" />
<section id="filters">
<h2>Filters<a class="headerlink" href="#filters" title="Link to this heading">¶</a></h2>
<p>Along the above mentioned filters, elosd also uses a
different set of filters to decide if an event shall be kept in the logging
backend, or not.
Clients can read not only from their event queues, but also events from the logging backend.
To receive not all of them they will - again - use filters to decide which are relevant for them.
There are many more applications of filters in elos and usually they will
encountered as a configuration option which needs to specify some filter strings.</p>
<p>Filters are created from filter rules, so called RPN-Filter (Reverse Polish
Notation [https://wikipedia.org/wiki/Reverse_Polish_notation]) i.e.:
<code class="docutils literal notranslate"><span class="pre">&quot;.event.source.appName</span> <span class="pre">'exampleName'</span> <span class="pre">STRCMP&quot;</span></code> would compare the string stored
in the event source application name (parameter 1) to the string ‘exampleName’
given as second parameter, while only events matching this string would be
received.</p>
<p>Another example is:
<code class="docutils literal notranslate"><span class="pre">&quot;.event.messageCode</span> <span class="pre">42</span> <span class="pre">EQ&quot;</span></code>
where all events with the messageCode “42” would be obtained.</p>
<p>RPN-Filter rules use the following syntax:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rule:<span class="w"> </span>Term<span class="p">|</span>Operant<span class="w"> </span>Operand<span class="w"> </span>Operator
Term:<span class="w"> </span>&lt;Operand&gt;<span class="w"> </span>&lt;Operand&gt;<span class="w"> </span>&lt;Operator&gt;
Operand:<span class="w"> </span>Process<span class="w"> </span><span class="p">|</span><span class="w"> </span>Event<span class="w"> </span><span class="p">|</span><span class="w"> </span>Value
Event:<span class="w"> </span>.event.&lt;field&gt;
Process:<span class="w"> </span>.process.&lt;field&gt;
Value:<span class="w"> </span>number<span class="p">|</span>string
Operator:<span class="w"> </span>EQ<span class="p">|</span>LT<span class="p">|</span>LE<span class="p">|</span>GT<span class="p">|</span>GE<span class="p">|</span>STRCMP<span class="p">|</span>AND<span class="p">|</span>OR
&lt;field&gt;:<span class="w"> </span>see<span class="w"> </span>chapter<span class="w"> </span>of<span class="w"> </span>corresponding<span class="w"> </span>filter<span class="w"> </span><span class="nb">type</span>
</pre></div>
</div>
<section id="event-filter">
<h3>Event-Filter<a class="headerlink" href="#event-filter" title="Link to this heading">¶</a></h3>
<p>Event-Filters are extended RPN-Filters, so they support the following
variables analogs to the canonical event format :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.event.source.pid</span></code> – match against process id of the source of an event</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.event.source.appname</span></code> – match against application name the source of an event</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.event.source.pid</span></code> – match against filename of the source of an event</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.event.severity</span></code> – match against severity of an event</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.event.hardwareid</span></code> – match against hardware id of an event</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.event.classification</span></code> – match against classification of an event</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.event.messageCode</span></code> – match against messageCode of an event</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.event.payload</span></code> – match against payload of an event</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.event.date.sec</span></code> – match against date of an event</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.event.date.nsec</span></code> – match against date of an event</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">.event</span></code> identifier can be abbreviated with <code class="docutils literal notranslate"><span class="pre">.ev</span></code> or <code class="docutils literal notranslate"><span class="pre">.e</span></code>.</p>
<section id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h4>
<p>Only match events about core dump created :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">messageCode</span> <span class="mi">5005</span> <span class="n">EQ</span>
</pre></div>
</div>
<p>Only match events published by the ‘init’-process</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">pid</span> <span class="mi">0</span> <span class="n">EQ</span>
</pre></div>
</div>
<p>Only match events of unauthorized publishing attempt.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">messageCode</span> <span class="mi">8007</span> <span class="n">EQ</span>
</pre></div>
</div>
<p>Only match events of severity <code class="docutils literal notranslate"><span class="pre">warning</span></code> and above.
(note: severity is 1 == FATAL to 6 == VERBOSE )</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">severity</span> <span class="mi">3</span> <span class="n">LE</span>
</pre></div>
</div>
<p>Only match events releated to security incidents with severity <code class="docutils literal notranslate"><span class="pre">warning</span></code> or higher.
(note: severity is 1 == FATAL to 6 == VERBOSE )</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">classification</span> <span class="mi">4</span> <span class="n">EQ</span> <span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">severity</span> <span class="mi">3</span> <span class="n">LE</span> <span class="n">AND</span>
</pre></div>
</div>
</section>
</section>
<section id="process-filter">
<h3>Process-Filter<a class="headerlink" href="#process-filter" title="Link to this heading">¶</a></h3>
<p>Process filters currently used to authorize processes to publish blacklisted
events. Process filters are extended RPN-Filters, so they support the following
variables:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.process.uid</span></code> – match against user id of the process</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.process.gid</span></code> – match against group id of the process</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.process.pid</span></code> – match against process id of the process</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.process.exec</span></code> – match against executable path of the process</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">.process</span></code> identifier can be abbreviated with <code class="docutils literal notranslate"><span class="pre">.proc</span></code> or <code class="docutils literal notranslate"><span class="pre">.p</span></code>.</p>
<section id="id1">
<h4>Examples<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<p>Only match process from <code class="docutils literal notranslate"><span class="pre">root</span></code> (uid==0) and <code class="docutils literal notranslate"><span class="pre">root</span></code> (gid==0) group:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">uid</span> <span class="mi">0</span> <span class="n">EQ</span> <span class="n">process</span><span class="o">.</span><span class="n">gid</span> <span class="n">EQ</span> <span class="n">AND</span>
</pre></div>
</div>
<p>Only match the ‘init’-process</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">pid</span> <span class="mi">0</span> <span class="n">EQ</span>
</pre></div>
</div>
<p>Only match the process by executable and user group <code class="docutils literal notranslate"><span class="pre">publisher</span></code> (publisher with gid == 100)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">gid</span> <span class="mi">100</span> <span class="n">EQ</span> <span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">exec</span> <span class="s1">&#39;/bin/elosc&#39;</span> <span class="n">STRCMP</span> <span class="n">AND</span>
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="scanner">
<h2>Scanner<a class="headerlink" href="#scanner" title="Link to this heading">¶</a></h2>
<p>Events are gathered from different sources and different sources have different formats to show their information.
To put these information into the - in sections “Events” - introduced canonical event format, a translation is needed
from the original displayed data to our events. These translators are called scanners, since they are reading - or
better “scanning” - the original text to receive everything needed to form an event out of it.</p>
<p>Since literally every program can be an event source, scanners are implemented as plugins. You can create your own scanner,
receiving whatever data and integrate it in elos, as long as the output will be in canonical event form.</p>
<p>Common system events like syslog or kernel messages and core dumps are already handled by scanners shipping with elos.</p>
<p>Depending on the installation on the local system, it might be necessary to set  <code class="docutils literal notranslate"><span class="pre">ELOS_SCANNER_PATH</span></code> to the directory where the scanner libraries are installed.</p>
<section id="syslog-scanner">
<h3>Syslog Scanner<a class="headerlink" href="#syslog-scanner" title="Link to this heading">¶</a></h3>
<p>The “system logging protocol” (syslog) is a standard protocol to transfer log messages. A syslog message is smaller
than 1024 byte and consists of a header and the message that shall be transferred itself. The header does split up
in the fields: priority, version, timestamp, hostname, app-name, procid, msgid and structured data. Since some of
the values are comparable with the attributes in our canonical event format, the syslog scanner will map them. An
example for a syslog message is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="mi">38</span><span class="o">&gt;</span><span class="n">Jan</span>  <span class="mi">1</span> <span class="mi">01</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">57</span> <span class="n">sshd</span><span class="p">[</span><span class="mi">240</span><span class="p">]:</span> <span class="n">Server</span> <span class="n">listening</span> <span class="n">on</span> <span class="p">::</span> <span class="n">port</span> <span class="mf">22.</span>
</pre></div>
</div>
<p>While the event we create from it could contain the following data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">date</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1641001317</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">severity</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;appName&quot;</span><span class="p">:</span><span class="s2">&quot;sshd&quot;</span><span class="p">,</span><span class="s2">&quot;pid&quot;</span><span class="p">:</span><span class="mi">240</span><span class="p">}</span>
<span class="n">hardware</span> <span class="nb">id</span> <span class="o">=</span> <span class="s2">&quot;4bfa155647104435a92b2a27486fd72c&quot;</span>
<span class="n">classification</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">messageCode</span> <span class="o">=</span> <span class="mi">2007</span>
<span class="n">payload</span> <span class="o">=</span> <span class="s2">&quot;Server listening on :: port 22.&quot;</span>
</pre></div>
</div>
</section>
<section id="kmsg-scanner">
<h3>Kmsg Scanner<a class="headerlink" href="#kmsg-scanner" title="Link to this heading">¶</a></h3>
<p>The kernel message (kmsg) scanner reads the kernel log ring buffer from the system file /dev/kmsg. The main idea of this file
is to collect all the information about the initial phase of the system startup and store it until a syslog daemon (which
is a receiver for syslog messages mentioned above) got started to pick them up. The file will also receive kernel messages
later on, i.e.: When a new usb device was plugged in.</p>
<p>Each line of the kmsg file will be treated as payload of a single event, while additional metadata will be created. The maximum
readable size of an entry is 4096 bytes. A kmsg line might look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">30</span><span class="p">,</span><span class="mi">744</span><span class="p">,</span><span class="mi">16663194</span><span class="p">,</span><span class="o">-</span><span class="p">;</span><span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">Listening</span> <span class="n">on</span> <span class="n">Syslog</span> <span class="n">Socket</span><span class="o">.</span>
</pre></div>
</div>
<p>The event created from this could look something like this:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;date&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1684239716</span><span class="p">,</span><span class="w"> </span><span class="mi">1668901000</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;source&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;fileName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;\/dev\/kmsg&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;severity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;classification&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;messageCode&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1111</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;30,744,16663194,-;systemd[1]: Listening on Syslog Socket.&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To subscribe on kernel log messages use a filter like ‘.event.messageCode 1111 EQ’, as the message code 1111 stands for “kernel log message”.
If the message could not be parsed the message code is set to 3422 (message not understood), severity and classification won’t be set in that case.</p>
</section>
<section id="netifd-scanner">
<h3>Netifd Scanner<a class="headerlink" href="#netifd-scanner" title="Link to this heading">¶</a></h3>
<p>Netifd is part of the OpenWrt project (a distribution for embedded devices - typically wireless routers). Netifd means
“network interface daemon” so its purpose is to manage network configurations. “Interfaces” represents configurations for
one or more devices in it, while devices represents either a physical linux interface (e.g. eth0), or a virtual link.
All device state transitions are announced via events i.e.: If a network interface is up or down. The contents of the
netifd events will be mapped by our netifd scanner to create canonical events out of it.</p>
</section>
</section>
<hr class="docutils" />
<section id="elos-tools">
<h2>Elos-Tools<a class="headerlink" href="#elos-tools" title="Link to this heading">¶</a></h2>
<section id="elos-coredump">
<h3>Elos-coredump<a class="headerlink" href="#elos-coredump" title="Link to this heading">¶</a></h3>
<p>Elos-coredump is an application to create events to be logged to the elos log, when a segmentation fault occurs and a
coredump file is to be created. Following is an example of an event created by elos-coredump and logged in elos log</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;date&quot;</span><span class="p">:[</span><span class="mi">203</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;source&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="nt">&quot;appName&quot;</span><span class="p">:</span><span class="s2">&quot;\/bin\/busybox.nosuid&quot;</span><span class="p">,</span>
<span class="w">     </span><span class="nt">&quot;fileName&quot;</span><span class="p">:</span><span class="s2">&quot;\/bin\/busybox.nosuid&quot;</span><span class="p">,</span>
<span class="w">     </span><span class="nt">&quot;pid&quot;</span><span class="p">:</span><span class="mi">475</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;severity&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;hardwareid&quot;</span><span class="p">:</span><span class="s2">&quot;eb-arm64&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;classification&quot;</span><span class="p">:</span><span class="mi">512</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;messageCode&quot;</span><span class="p">:</span><span class="mi">5005</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="s2">&quot;core dumped to \/tmp\/core.203.475, signal=6, UID=0, GID=0&quot;</span>
<span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<section id="elos-coredump-installation">
<h4>Elos-coredump Installation<a class="headerlink" href="#elos-coredump-installation" title="Link to this heading">¶</a></h4>
<p>The elos-coredump tool is built and installed along with elos as given in the
installation section.
After installation is complete, the kernel core-pattern needs to be setup to ensure that coredumps are piped to elos-coredump.
This can be achieved by running <code class="docutils literal notranslate"><span class="pre">elos-coredump</span></code> as <code class="docutils literal notranslate"><span class="pre">root</span></code>. This run, sets the value <code class="docutils literal notranslate"><span class="pre">|&lt;PATH_TO_COREDUMP_BINARY&gt;/elos-coredump</span> <span class="pre">%P</span> <span class="pre">%E</span> <span class="pre">%u</span> <span class="pre">%g</span> <span class="pre">%s</span> <span class="pre">%t</span> <span class="pre">%h</span></code>
in the <code class="docutils literal notranslate"><span class="pre">/proc/sys/kernel/core_pattern</span></code> file.</p>
</section>
<section id="usage">
<h4>Usage<a class="headerlink" href="#usage" title="Link to this heading">¶</a></h4>
<p>To run elos-coredump manually the following arguments are required :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">expected</span> <span class="n">order</span> <span class="n">of</span> <span class="n">specifiers</span><span class="p">:</span>

  <span class="o">%</span><span class="n">P</span> <span class="o">%</span><span class="n">E</span> <span class="o">%</span><span class="n">u</span> <span class="o">%</span><span class="n">g</span> <span class="o">%</span><span class="n">s</span> <span class="o">%</span><span class="n">t</span> <span class="o">%</span><span class="n">h</span>

   <span class="n">where</span><span class="p">:</span>
   <span class="o">%</span><span class="n">P</span><span class="p">:</span> <span class="n">PID</span> <span class="n">of</span> <span class="n">dumped</span> <span class="n">process</span>
   <span class="o">%</span><span class="n">E</span><span class="p">:</span> <span class="n">Pathname</span> <span class="n">of</span> <span class="n">executable</span><span class="p">,</span> <span class="k">with</span> <span class="n">slashes</span> <span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="n">replaced</span> <span class="n">by</span> <span class="n">exclamation</span> <span class="n">marks</span> <span class="p">(</span><span class="s1">&#39;!&#39;</span><span class="p">)</span>
   <span class="o">%</span><span class="n">u</span><span class="p">:</span> <span class="n">Numeric</span> <span class="n">real</span> <span class="n">UID</span> <span class="n">of</span> <span class="n">dumped</span> <span class="n">process</span><span class="o">.</span>
   <span class="o">%</span><span class="n">g</span><span class="p">:</span> <span class="n">Numeric</span> <span class="n">real</span> <span class="n">GID</span> <span class="n">of</span> <span class="n">dumped</span> <span class="n">process</span><span class="o">.</span>
   <span class="o">%</span><span class="n">s</span><span class="p">:</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">signal</span> <span class="n">causing</span> <span class="n">dump</span><span class="o">.</span>
   <span class="o">%</span><span class="n">t</span><span class="p">:</span> <span class="n">Time</span> <span class="n">of</span> <span class="n">dump</span><span class="p">,</span> <span class="n">expressed</span> <span class="k">as</span> <span class="n">seconds</span> <span class="n">since</span> <span class="n">the</span> <span class="n">Epoch</span><span class="p">,</span> <span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="o">+</span><span class="mi">0000</span> <span class="p">(</span><span class="n">UTC</span><span class="p">)</span><span class="o">.</span>
   <span class="o">%</span><span class="n">h</span><span class="p">:</span> <span class="n">Hostname</span>

</pre></div>
</div>
<p>See manpage (man 5 core) for more details about core pattern and the different specifiers used here.</p>
<p>When elos-coredump is run manually it is not necessary for the core patterns, to be set. They can be set
in the call to run elos-coredump as illustrated below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># subscribe to to a coredump event</span>
<span class="n">root</span><span class="nd">@eb</span><span class="o">-</span><span class="n">arm64</span><span class="p">:</span><span class="o">~</span><span class="c1"># elosc -s &quot;.event.messageCode 5005 EQ&quot; &amp;</span>
<span class="n">root</span><span class="nd">@eb</span><span class="o">-</span><span class="n">arm64</span><span class="p">:</span><span class="o">~</span><span class="c1"># Connecting to elosd...</span>
<span class="n">Get</span> <span class="n">elosd</span> <span class="n">version</span><span class="o">...</span>
  <span class="n">Elosd</span> <span class="n">version</span> <span class="ow">is</span> <span class="s1">&#39;0.38.9.20c39c7b&#39;</span>
  <span class="n">subscribing</span> <span class="k">with</span> <span class="n">filterRule</span> <span class="s1">&#39;.event.messageCode 5005 EQ&#39;</span>
  <span class="n">polling</span> <span class="k">for</span> <span class="n">new</span> <span class="n">events</span><span class="o">...</span>

<span class="c1"># Trigger coredump by passing required arguments to elos-coredump</span>
<span class="n">root</span><span class="nd">@eb</span><span class="o">-</span><span class="n">arm64</span><span class="p">:</span><span class="o">~</span><span class="c1"># echo &quot;THIS IS THE DUMP&quot; | /usr/bin/elos-coredump 1 /usr/bin/somebinary 2 3 11 333333 myhostname</span>
<span class="n">coredump</span> <span class="n">started</span>
<span class="n">wrote</span> <span class="n">coredump</span> <span class="n">file</span> <span class="s1">&#39;/tmp/core.333333.1&#39;</span> <span class="k">with</span> <span class="mi">17</span> <span class="nb">bytes</span>
<span class="n">connecting</span> <span class="n">coredump</span> <span class="n">to</span> <span class="n">event</span> <span class="n">log</span> <span class="n">scanner</span><span class="o">...</span>
<span class="n">send</span> <span class="n">coredump</span> <span class="n">event</span> <span class="n">to</span> <span class="n">log</span> <span class="n">scanner</span><span class="o">...</span>
<span class="n">disconnecting</span> <span class="n">coredump</span> <span class="kn">from</span> <span class="nn">event</span> <span class="n">log</span> <span class="n">scanner</span><span class="o">...</span>
<span class="n">coredump</span> <span class="n">done</span>

<span class="c1"># subscribed elos client captures coredump event</span>
<span class="n">root</span><span class="nd">@eb</span><span class="o">-</span><span class="n">arm64</span><span class="p">:</span><span class="o">~</span><span class="c1">#   new data [5964,163307136]:</span>
<span class="p">[{</span><span class="s2">&quot;date&quot;</span><span class="p">:[</span><span class="mi">333333</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;source&quot;</span><span class="p">:{</span><span class="s2">&quot;appName&quot;</span><span class="p">:</span><span class="s2">&quot;\/usr\/bin\/somebinary&quot;</span><span class="p">,</span><span class="s2">&quot;fileName&quot;</span><span class="p">:</span><span class="s2">&quot;\/usr\/bin\/somebinary&quot;</span><span class="p">,</span><span class="s2">&quot;pid&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="s2">&quot;severity&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;hardwareid&quot;</span><span class="p">:</span><span class="s2">&quot;myhostname&quot;</span><span class="p">,</span><span class="s2">&quot;classification&quot;</span><span class="p">:</span><span class="mi">512</span><span class="p">,</span><span class="s2">&quot;messageCode&quot;</span><span class="p">:</span><span class="mi">5005</span><span class="p">,</span><span class="s2">&quot;payload&quot;</span><span class="p">:</span><span class="s2">&quot;core dumped to \/tmp\/core.333333.1, signal=11, UID=2, GID=3&quot;</span><span class="p">}]</span>

<span class="c1"># Coredump file with given coredump data</span>
<span class="n">root</span><span class="nd">@eb</span><span class="o">-</span><span class="n">arm64</span><span class="p">:</span><span class="o">~</span><span class="c1"># ls -lah /tmp/core.333333.1</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>    <span class="mi">1</span> <span class="n">root</span>     <span class="n">root</span>          <span class="mi">17</span> <span class="n">Jan</span>  <span class="mi">1</span> <span class="mi">01</span><span class="p">:</span><span class="mi">39</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">core</span><span class="mf">.333333.1</span>
<span class="n">root</span><span class="nd">@eb</span><span class="o">-</span><span class="n">arm64</span><span class="p">:</span><span class="o">~</span><span class="c1"># cat /tmp/core.333333.1</span>
<span class="n">THIS</span> <span class="n">IS</span> <span class="n">THE</span> <span class="n">DUMP</span>

</pre></div>
</div>
<p>An Example of how a coredump shall be piped to elos-coredump via core_patterns is demonstrated below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="c1">#set core pattern</span>
<span class="n">root</span><span class="nd">@eb</span><span class="o">-</span><span class="n">arm64</span><span class="p">:</span><span class="o">~</span><span class="c1"># elos-coredump</span>
<span class="n">coredump</span> <span class="n">started</span>
<span class="n">coredump</span> <span class="n">called</span> <span class="n">without</span> <span class="n">parameter</span> <span class="o">-</span> <span class="n">setup</span> <span class="n">core_pattern</span>
<span class="n">coredump</span> <span class="n">core_pattern</span> <span class="n">setup</span> <span class="n">done</span>

<span class="c1">#check is core pattern is set</span>
<span class="n">root</span><span class="nd">@eb</span><span class="o">-</span><span class="n">arm64</span><span class="p">:</span><span class="o">~</span><span class="c1"># cat /proc/sys/kernel/core_pattern</span>
<span class="o">|/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">elos</span><span class="o">-</span><span class="n">coredump</span> <span class="o">%</span><span class="n">P</span> <span class="o">%</span><span class="n">E</span> <span class="o">%</span><span class="n">u</span> <span class="o">%</span><span class="n">g</span> <span class="o">%</span><span class="n">s</span> <span class="o">%</span><span class="n">t</span> <span class="o">%</span><span class="n">h</span>

<span class="c1"># subscribe to to a coredump event</span>
<span class="n">root</span><span class="nd">@eb</span><span class="o">-</span><span class="n">arm64</span><span class="p">:</span><span class="o">~</span><span class="c1"># elosc -s &quot;.event.messageCode 5005 EQ&quot; &amp;</span>
<span class="n">root</span><span class="nd">@eb</span><span class="o">-</span><span class="n">arm64</span><span class="p">:</span><span class="o">~</span><span class="c1"># Connecting to elosd...</span>
<span class="n">Get</span> <span class="n">elosd</span> <span class="n">version</span><span class="o">...</span>
  <span class="n">Elosd</span> <span class="n">version</span> <span class="ow">is</span> <span class="s1">&#39;0.38.9.20c39c7b&#39;</span>
  <span class="n">subscribing</span> <span class="k">with</span> <span class="n">filterRule</span> <span class="s1">&#39;.event.messageCode 5005 EQ&#39;</span>
  <span class="n">polling</span> <span class="k">for</span> <span class="n">new</span> <span class="n">events</span><span class="o">...</span>

<span class="c1"># trigger an coredump</span>
<span class="n">root</span><span class="nd">@eb</span><span class="o">-</span><span class="n">arm64</span><span class="p">:</span><span class="o">~</span><span class="c1"># sleep 100 &amp;</span>
<span class="n">root</span><span class="nd">@eb</span><span class="o">-</span><span class="n">arm64</span><span class="p">:</span><span class="o">~</span><span class="c1"># pgrep sleep</span>
<span class="mi">475</span>
<span class="n">root</span><span class="nd">@eb</span><span class="o">-</span><span class="n">arm64</span><span class="p">:</span><span class="o">~</span><span class="c1"># kill -ABRT 475</span>

<span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span>  <span class="n">Aborted</span> <span class="p">(</span><span class="n">core</span> <span class="n">dumped</span><span class="p">)</span>      <span class="n">sleep</span> <span class="mi">100</span>

<span class="c1"># Triggered coredump generates an new event and it is logged.</span>
<span class="c1"># Logged event is then accessible to subscribed elos client.</span>
<span class="n">root</span><span class="nd">@eb</span><span class="o">-</span><span class="n">arm64</span><span class="p">:</span><span class="o">~</span><span class="c1">#   new data [203,936636528]:</span>
  <span class="p">[{</span><span class="s2">&quot;date&quot;</span><span class="p">:[</span><span class="mi">203</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;source&quot;</span><span class="p">:{</span><span class="s2">&quot;appName&quot;</span><span class="p">:</span><span class="s2">&quot;\/bin\/busybox.nosuid&quot;</span><span class="p">,</span><span class="s2">&quot;fileName&quot;</span><span class="p">:</span><span class="s2">&quot;\/bin\/busybox.nosuid&quot;</span><span class="p">,</span><span class="s2">&quot;pid&quot;</span><span class="p">:</span><span class="mi">475</span><span class="p">},</span><span class="s2">&quot;severity&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;hardwareid&quot;</span><span class="p">:</span><span class="s2">&quot;eb-arm64&quot;</span><span class="p">,</span><span class="s2">&quot;classification&quot;</span><span class="p">:</span><span class="mi">512</span><span class="p">,</span><span class="s2">&quot;messageCode&quot;</span><span class="p">:</span><span class="mi">5005</span><span class="p">,</span><span class="s2">&quot;payload&quot;</span><span class="p">:</span><span class="s2">&quot;core dumped to \/tmp\/core.203.475, signal=6, UID=0, GID=0&quot;</span><span class="p">}]</span>

<span class="c1"># coredump file created by default in /tmp</span>
<span class="n">root</span><span class="nd">@eb</span><span class="o">-</span><span class="n">arm64</span><span class="p">:</span><span class="o">~</span><span class="c1"># ls -lah /tmp/core.203.475</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>    <span class="mi">1</span> <span class="n">root</span>     <span class="n">root</span>      <span class="mf">296.0</span><span class="n">K</span> <span class="n">Jan</span>  <span class="mi">1</span> <span class="mi">00</span><span class="p">:</span><span class="mi">03</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">core</span><span class="mf">.203.475</span>

</pre></div>
</div>
</section>
</section>
</section>
<section id="elosd-installation-setup">
<h2>elosd - Installation &amp; Setup<a class="headerlink" href="#elosd-installation-setup" title="Link to this heading">¶</a></h2>
<p>This section will cover the topic of how elos has to be installed.
If you have elos already installed in an image, you can safely skip this chapter.
First of all: We have to make a difference between the elos daemon (elosd) which
is the server application and can be considered elos itself, and elos clients (which will be
named elosc onwards) where - in fact - no installation is needed: As long as messages are send in the right way, the elosd
will answer you. You might communicate with it from a different device just using the terminal. However, we do have an
elosc demo program to simplify the communication. But let’s start with the main thing.</p>
<section id="get-elos-project">
<h3>Get elos Project<a class="headerlink" href="#get-elos-project" title="Link to this heading">¶</a></h3>
<p>Elos sourcecode is located in a git repository.</p>
</section>
<section id="build-and-installation">
<h3>Build And Installation<a class="headerlink" href="#build-and-installation" title="Link to this heading">¶</a></h3>
<p>As soon as you have elos, you need to build it. elos has different dependencies. To install all the dependencies in a Debian based system, execute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">locales</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span> <span class="n">binutils</span><span class="o">-</span><span class="n">dev</span> <span class="n">pkg</span><span class="o">-</span><span class="n">config</span> <span class="n">cmake</span> <span class="n">ninja</span><span class="o">-</span><span class="n">build</span> <span class="n">libcsv</span><span class="o">-</span><span class="n">dev</span> <span class="n">libcmocka</span><span class="o">-</span><span class="n">dev</span> \
<span class="n">zlib1g</span><span class="o">-</span><span class="n">dev</span> <span class="n">libiberty</span><span class="o">-</span><span class="n">dev</span> <span class="n">wget</span> <span class="n">jq</span> <span class="n">libjson</span><span class="o">-</span><span class="n">c</span><span class="o">-</span><span class="n">dev</span> <span class="n">curl</span> <span class="n">gdb</span> <span class="n">netcat</span> <span class="n">net</span><span class="o">-</span><span class="n">tools</span> <span class="n">linux</span><span class="o">-</span><span class="n">tools</span><span class="o">-</span><span class="n">generic</span> <span class="n">libssl</span><span class="o">-</span><span class="n">dev</span> <span class="n">openssl</span> \
<span class="n">sqlite3</span> <span class="n">libsqlite3</span><span class="o">-</span><span class="mi">0</span> <span class="n">libsqlite3</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>Then navigate to the directory where you have stored the elos project and use the following command lines to build and install it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">-</span><span class="n">B</span> <span class="o">./</span><span class="n">build</span><span class="o">-</span><span class="n">safu</span><span class="o">/</span> <span class="o">./</span><span class="n">safu</span><span class="o">/</span> <span class="o">-</span><span class="n">D</span> <span class="n">UNIT_TESTS</span><span class="o">=</span><span class="n">OFF</span>
<span class="n">make</span> <span class="o">-</span><span class="n">C</span> <span class="n">build</span><span class="o">-</span><span class="n">safu</span><span class="o">/</span>
<span class="n">sudo</span> <span class="n">make</span> <span class="o">-</span><span class="n">C</span> <span class="n">build</span><span class="o">-</span><span class="n">safu</span><span class="o">/</span> <span class="n">install</span>

<span class="n">cmake</span> <span class="o">-</span><span class="n">B</span> <span class="o">./</span><span class="n">build</span><span class="o">-</span><span class="n">samconf</span><span class="o">/</span> <span class="o">./</span><span class="n">samconf</span><span class="o">/</span> <span class="o">-</span><span class="n">D</span> <span class="n">UNIT_TESTS</span><span class="o">=</span><span class="n">OFF</span>
<span class="n">make</span> <span class="o">-</span><span class="n">C</span> <span class="n">build</span><span class="o">-</span><span class="n">samconf</span><span class="o">/</span>
<span class="n">sudo</span> <span class="n">make</span> <span class="o">-</span><span class="n">C</span> <span class="n">build</span><span class="o">-</span><span class="n">samconf</span><span class="o">/</span> <span class="n">install</span>

<span class="n">cmake</span> <span class="o">-</span><span class="n">B</span> <span class="o">./</span><span class="n">build</span><span class="o">-</span><span class="n">elos</span><span class="o">/</span> <span class="o">./</span><span class="n">elos</span><span class="o">/</span> <span class="o">-</span><span class="n">D</span> <span class="n">UNIT_TESTS</span><span class="o">=</span><span class="n">OFF</span>
<span class="n">make</span> <span class="o">-</span><span class="n">C</span> <span class="n">build</span><span class="o">-</span><span class="n">elos</span><span class="o">/</span>
<span class="n">sudo</span> <span class="n">make</span> <span class="o">-</span><span class="n">C</span> <span class="n">build</span><span class="o">-</span><span class="n">elos</span><span class="o">/</span> <span class="n">install</span>

<span class="n">sudo</span> <span class="n">ldconfig</span>
</pre></div>
</div>
<p>These libraries will create our software parts: safu, samconf and elos. Since elos depends on safu and samconf, the correct
build-order is important. If a build failed for whatever reason, just delete the build directory, solve the problem written in text
and try again.</p>
<p>The last instruction (ldconfig) updates the symbolic links for shared libraries, since we added a few and elos needs to find them.</p>
<p>If these lines of code succeeded, than congrats: You have successfully installed a working elos daemon.</p>
<section id="packing">
<h4>Packing<a class="headerlink" href="#packing" title="Link to this heading">¶</a></h4>
<p>Creating the debian packages for elos and the other elos tools is possible by
calling</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shared</span><span class="o">/</span><span class="n">ci</span><span class="o">/</span><span class="n">package_all</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>from the <code class="docutils literal notranslate"><span class="pre">/base</span></code> directory inside the docker container.</p>
<p>Other ways to generate the packages are by calling</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ci</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">sh</span> <span class="o">--</span><span class="n">package</span>
<span class="n">ci</span><span class="o">/</span><span class="n">package</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>inside each subprojects directory, inside the docker container.</p>
<p>In general, by reconfiguring the paths inside each subprojects <code class="docutils literal notranslate"><span class="pre">Packing.cmake</span></code>
to work outside the docker, it is possible to build a subprojects package with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">-</span><span class="n">B</span> <span class="o">&lt;</span><span class="n">build_dir</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">project_dir</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">D</span> <span class="n">UNIT_TESTS</span><span class="o">=</span><span class="n">ON</span> <span class="o">-</span><span class="n">D</span> <span class="n">PACKAGE</span><span class="o">=</span><span class="n">ON</span> <span class="o">-</span><span class="n">D</span> <span class="n">CMAKE_BUILD_TYPE</span><span class="o">=</span><span class="n">Release</span>
<span class="n">make</span> <span class="o">-</span><span class="n">C</span> <span class="o">&lt;</span><span class="n">build_dir</span><span class="o">&gt;</span>
<span class="n">make</span> <span class="o">-</span><span class="n">C</span> <span class="o">&lt;</span><span class="n">build_dir</span><span class="o">&gt;</span> <span class="n">install</span>
<span class="n">cd</span> <span class="o">&lt;</span><span class="n">build_dir</span><span class="o">&gt;/</span><span class="n">Release</span><span class="o">/</span><span class="n">cmake</span>
<span class="n">cpack</span> <span class="o">-</span><span class="n">G</span> <span class="n">DEB</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="setup-to-make-it-work">
<h3>Setup To Make It Work<a class="headerlink" href="#setup-to-make-it-work" title="Link to this heading">¶</a></h3>
<p>There are still a few steps remaining to configure it correctly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">elos</span><span class="o">/</span>
<span class="n">sudo</span> <span class="n">cp</span> <span class="n">elos</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">elosd</span><span class="o">/</span><span class="n">elosd</span><span class="o">.</span><span class="n">json</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">elos</span><span class="o">/</span>
</pre></div>
</div>
<p>Copies the elosd.json file from our project to /etc/elos. This file is mandatory, to tell elos, where to find its scanner, backend-
log-file and network ports to communicate. Therefore, it is filled with standard values while the user might want to change a few
directories according to personal system settings and preferences. A description of file contents can be found in the next section.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">touch</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">elosd</span><span class="o">.</span><span class="n">log</span>
<span class="n">sudo</span> <span class="n">chown</span> <span class="s2">&quot;$USER&quot;</span><span class="p">:</span><span class="s2">&quot;$USER&quot;</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">elosd</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
<p>Creates the elosd json backend file at its standard location. Received events will get stored in it line-by-line.
You can change the location to another place if you like, in the way described below.</p>
</section>
</section>
<hr class="docutils" />
<section id="elosd-configuration-options-explained">
<h2>elosd Configuration - Options Explained<a class="headerlink" href="#elosd-configuration-options-explained" title="Link to this heading">¶</a></h2>
<p>By default the elosd config options, stored in ‘/etc/elos/elosd.json’ do look like this:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;root&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;elos&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;UseEnv&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Port&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">54321</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Interface&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;ConnectionLimit&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;LogFilter&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;connectionmanager.c;dispatcher.c;message_handler.c;message_event_create.c;message_event_push.c&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;LogLevel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;EventBlacklist&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.event.messageCode 2000 EQ&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;authorizedProcesses&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="s2">&quot;.process.uid 0 EQ .process.gid 0 EQ .process.exec &#39;/bin/elosc&#39; STRCMP AND&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s2">&quot;.process.gid 200 EQ .process.exec &#39;/bin/elosc&#39; STRCMP AND&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s2">&quot;.process.pid 1 EQ&quot;</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;EventLogging&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;PluginSearchPath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/usr/lib/x86_64-linux-gnu/elos/backend&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;Plugins&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;Dummy&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nt">&quot;File&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;backend_dummy.so&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;Run&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;always&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;Filters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                            </span><span class="s2">&quot;1 1 EQ&quot;</span>
<span class="w">                        </span><span class="p">]</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="nt">&quot;JsonBackend&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nt">&quot;File&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;backend_json.so&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;Run&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;always&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;Filters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                            </span><span class="s2">&quot;1 1 EQ&quot;</span>
<span class="w">                        </span><span class="p">]</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;StorageBackend&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;Json&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;File&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/var/log/elos/elosd_event.log&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;Scanner&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;Path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/usr/local/lib/elos/scanner&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;KmsgScanner&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;KmsgFile&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/dev/kmsg&quot;</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;SyslogScanner&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;SyslogPath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/dev/log&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;MappingRules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nt">&quot;MessageCodes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                          </span><span class="nt">&quot;4000&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.event.source.appName &#39;ssh&#39; STRCMP&quot;</span><span class="p">,</span>
<span class="w">                          </span><span class="nt">&quot;2000&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.event.source.appName &#39;crinit&#39; STRCMP&quot;</span><span class="p">,</span>
<span class="w">                          </span><span class="nt">&quot;1000&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.event.source.appName &#39;login&#39; STRCMP&quot;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>These options are used if the UseEnv variable is set to false. Otherwise elos will use environment variables (if there are any defined).
The elosd options are listed below in order top to bottom. The name of the environment variable you might want to use in case you set
“UseEnv” to true, will be attached in brackets (). If UseEnv is true and the respective environment variables are not set, the config
option will be used instead. If the config option is missing or not readable, elos will use another default value, decided by us.</p>
<ul class="simple">
<li><p><strong>UseEnv</strong>: Define if elosd will allow overwrite configuration values by environment variables</p></li>
<li><p><strong>Port</strong>: The network port number elosd shall use (<code class="docutils literal notranslate"><span class="pre">ELOSD_PORT</span></code>, default value: <code class="docutils literal notranslate"><span class="pre">54321</span></code>)</p></li>
<li><p><strong>Interface</strong>: The IPv4 address the elosd server will have (<code class="docutils literal notranslate"><span class="pre">ELOSD_INTERFACE</span></code> default value: <code class="docutils literal notranslate"><span class="pre">&quot;0.0.0.0&quot;</span></code>)</p></li>
<li><p><strong>ConnectionLimit</strong>: The maximum number of clients that can be connecte to the server simultaneously(<code class="docutils literal notranslate"><span class="pre">ELOSD_CONNECTION_LIMIT</span></code> default value: <code class="docutils literal notranslate"><span class="pre">200</span></code>)</p></li>
<li><p><strong>LogFilter</strong>: Only log messages from these C-Files are shown, don’t touch it except you know what you’re doing (<code class="docutils literal notranslate"><span class="pre">ELOS_LOG_FILTER</span></code> default value: <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>); files are separated by <code class="docutils literal notranslate"><span class="pre">;</span></code> i.e. <code class="docutils literal notranslate"><span class="pre">&quot;first.c;second.c&quot;</span></code></p></li>
<li><p><strong>LogLevel</strong>: Severity levels deciding how much information will be printed from no messages to extremely detailed the levels are:
Off, Fatal, Error, Warn, Info, Debug and Verbose (<code class="docutils literal notranslate"><span class="pre">ELOS_LOG_LEVEL</span></code> default value: <code class="docutils literal notranslate"><span class="pre">&quot;Debug&quot;</span></code>)</p></li>
<li><p><strong>EventBlacklist</strong>: Event filter that filters events into critical and non-critical events so that critical events cannot be published by unauthorized clients.</p></li>
<li><p><strong>authorizedProcesses</strong>: A list of process filters that determines if a client is authorized to publish critical events.</p></li>
<li><p><strong>StorageBackend/Json/File</strong>: The file where elosd will store all the logged events (<code class="docutils literal notranslate"><span class="pre">ELOS_STORAGE_BACKEND_JSON_FILE</span></code>)</p></li>
<li><p><strong>Scanner/Path</strong>: Path to the scanner plugins (<code class="docutils literal notranslate"><span class="pre">ELOS_SCANNER_PATH</span></code> default value: <code class="docutils literal notranslate"><span class="pre">&quot;/usr/lib/elos/scanner&quot;</span></code>)</p></li>
<li><p><strong>Scanner/KmsgScanner/KmsgFile</strong>: Character device or FIFO file node to receive logs in kmsg format from (<code class="docutils literal notranslate"><span class="pre">ELOS_KMSG_FILE</span></code> default value: <code class="docutils literal notranslate"><span class="pre">&quot;/dev/kmsg&quot;</span></code>)</p></li>
<li><p><strong>Scanner/SyslogScanner/SyslogPath</strong>: Unix UDP socket to receive logs in syslog format from (<code class="docutils literal notranslate"><span class="pre">ELOS_SYSLOG_PATH</span></code> default value: <code class="docutils literal notranslate"><span class="pre">&quot;/dev/log&quot;</span></code>)</p></li>
<li><p><strong>Scanner/SyslogScanner/MappingRules/MessageCodes</strong>: contain <code class="docutils literal notranslate"><span class="pre">message</span> <span class="pre">code,</span> <span class="pre">filter</span></code> pairs to set a specific <code class="docutils literal notranslate"><span class="pre">message</span> <span class="pre">code</span></code> for an event if the given filter matches the event.</p></li>
</ul>
<p>Note: You can create/overwrite environment variables by typing something like i.e.: <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">ELOSD_PORT='1234'</span></code>
If you want to store them permanently, you can add them to your <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> file.
You can also change the location where elosd expects its configuration by setting the environment variable ‘ELOS_CONFIG_PATH’</p>
<section id="event-authorization">
<h3>Event Authorization<a class="headerlink" href="#event-authorization" title="Link to this heading">¶</a></h3>
<p>Event authorization is implemented by setting two filters in the config file. The two filters are :</p>
<ul class="simple">
<li><p>EventBlacklist: This is an event filter which separtes an event into critical and non-crtical events and blacklists it, if critical, to prevent it from being published by an
unauthorized client.</p></li>
<li><p>authorizedProcesses: This is a list of process filters which determines if a client is an authorized process, so that the client is able to publish
critical events.</p></li>
</ul>
<p>Only an authorized process i.e. those that match any of the <code class="docutils literal notranslate"><span class="pre">authorizedProcesses</span></code> filter in the config can publish any event, even those events that match
the <code class="docutils literal notranslate"><span class="pre">EventBlacklist</span></code> filter in the config. Other clients will be able to publish only those events that do not match the <code class="docutils literal notranslate"><span class="pre">EventBlacklist</span></code> filter.</p>
<section id="dependency">
<h4>Dependency<a class="headerlink" href="#dependency" title="Link to this heading">¶</a></h4>
<p>It is assumed that the system has the following dependencies to use this feature</p>
<ul class="simple">
<li><p>Linux kernel with netlink and <code class="docutils literal notranslate"><span class="pre">inet_diag</span></code> enabled:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONFIG_NETLINK_DIAG</span><span class="o">=</span><span class="n">y</span>
<span class="n">CONFIG_INET_DIAG</span><span class="o">=</span><span class="n">y</span>
<span class="n">CONFIG_TCP_DIAG</span><span class="o">=</span><span class="n">y</span>
</pre></div>
</div>
<ul class="simple">
<li><p>elos needs to run as root</p></li>
<li><p>libmnl library is installed</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section id="elosd-start-and-test">
<h2>elosd Start and Test<a class="headerlink" href="#elosd-start-and-test" title="Link to this heading">¶</a></h2>
<p>After all the settings are done, the elos daemon can be started for debugging with i.e.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">ELOS_LOG_LEVEL</span><span class="o">=</span><span class="n">DEBUG</span> <span class="n">elosd</span>
</pre></div>
</div>
<p>Since the daemon needs a log level to decide which messages shall be printed and which not. The “sudo” is necessary to enable the
elosd to receive the kernel message log (kmsg) and the syslog, or otherwise, the kmsg and syslog scanners won’t work.</p>
<p>The syslog scanner tries per default to climb the unix DGRAM socket /dev/log to receive syslog messages. Please keep in mind that this
path can also be changed in the config options, which is especially recommended on systems that are already monitoring /dev/log with
systemd. If /dev/log is already taken, elosd won’t be able to open it.
(You can find out if this is the case on your system, when you type <code class="docutils literal notranslate"><span class="pre">journalctl</span> <span class="pre">-f</span></code> and get a log response from systemd, or simply
type <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">-lah</span> <span class="pre">/dev/log</span></code> before starting elos the first time, to check if this path already exists.)</p>
<p>Regardless if different scanners are working or not, the terminal which started elosd should end with the message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">ELOSD</span><span class="p">]</span> <span class="n">Running</span><span class="o">...</span>
</pre></div>
</div>
<p>Now you will be able to send messages to elosd and get them logged.</p>
<p>You can test to send and receive a message by typing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">elosc</span> <span class="o">-</span><span class="n">s</span> <span class="s2">&quot;.event.source.appName &#39;sshd&#39; STRCMP&quot;</span> <span class="o">&amp;</span>
</pre></div>
</div>
<p>in a new terminal which starts a listening client for events from the sshd.
Then use another terminal and type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">elosc</span> <span class="o">-</span><span class="n">p</span> <span class="s1">&#39;{&quot;source&quot;: { &quot;appName&quot;:&quot;sshd&quot;}, &quot;payload&quot;: &quot;test&quot;}&#39;</span>
</pre></div>
</div>
<p>To push the event behind the “-p” to the server. Since the filter given to the subscribe command matches the pushed event,
the event will be transmitted to it. You should see an output on the listening terminal that looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">new</span> <span class="n">data</span> <span class="p">[</span><span class="mi">1669298051</span><span class="p">,</span><span class="mi">246902710</span><span class="p">]:</span>
<span class="p">[{</span><span class="s2">&quot;date&quot;</span><span class="p">:[</span><span class="mi">1669298051</span><span class="p">,</span><span class="mi">236492733</span><span class="p">],</span><span class="s2">&quot;source&quot;</span><span class="p">:{</span><span class="s2">&quot;appName&quot;</span><span class="p">:</span><span class="s2">&quot;sshd&quot;</span><span class="p">},</span><span class="s2">&quot;payload&quot;</span><span class="p">:</span><span class="s2">&quot;test&quot;</span><span class="p">}]</span>
</pre></div>
</div>
<p>Similarly</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">elosc</span> <span class="o">-</span><span class="n">f</span> <span class="s2">&quot;.event.source.appName &#39;sshd&#39; STRCMP&quot;</span>
</pre></div>
</div>
<p>will find events which already happened which find events which already happened that match the given filter rule.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new</span> <span class="n">data</span><span class="p">:</span>
<span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:[</span><span class="mi">1669297969</span><span class="p">,</span><span class="mi">738218916</span><span class="p">],</span><span class="s2">&quot;source&quot;</span><span class="p">:{</span><span class="s2">&quot;appName&quot;</span><span class="p">:</span><span class="s2">&quot;sshd&quot;</span><span class="p">},</span><span class="s2">&quot;payload&quot;</span><span class="p">:</span><span class="s2">&quot;test&quot;</span><span class="p">}</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="event-inputs-scanner-setup">
<h2>[Event-Inputs] Scanner Setup<a class="headerlink" href="#event-inputs-scanner-setup" title="Link to this heading">¶</a></h2>
<p>Since scanners are like plugins and we can have a different amount of them, which are working all differently, we decided to
create a generic component which is capable of mapping values to the different canonical event properties according to one
or more configurable rules. These mapping rules can be defined in configuration files for the scanners.
This makes it easy to define new scanners and add them to the elosd. Refer to the documentation on how to
write a new scanner.</p>
<p>So for example to assign a message code to a new event depending on the original input the <code class="docutils literal notranslate"><span class="pre">MappingComponent</span></code> needs the following
inputs :</p>
<ul class="simple">
<li><p>A mapping rule</p></li>
<li><p>The input</p></li>
<li><p>The event with values already mapped</p></li>
<li><p>A result, which should be applied if the rule matches</p></li>
</ul>
<p>When creating a mapping or filter rule, you can use the following filter names:</p>
<ul class="simple">
<li><p>“.event.source.pid”: Filter by the process id of a source</p></li>
<li><p>“.event.source.appName”: Filter by the software name of a source</p></li>
<li><p>“.event.source.file”: Filter by the executable/file name of a source</p></li>
<li><p>“.event.severity”: Filter by the severity of the event</p></li>
<li><p>“.event.hardwareid”: Filter by the hardware id given to the event</p></li>
<li><p>“.event.messagerCode”: Filter by the message code assigned to the event</p></li>
<li><p>“.event.payload”: Filter by the message of the event, only supports exact matches</p></li>
</ul>
<p>A single mapping rule maps an event to a rpn-filter rule. RPN-Filter rules use the following syntax:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rule:<span class="w"> </span>Term<span class="p">|</span>Operant<span class="w"> </span>Operand<span class="w"> </span>Operator
Term:<span class="w"> </span>&lt;Operand&gt;<span class="w"> </span>&lt;Operand&gt;<span class="w"> </span>&lt;Operator&gt;
Operand:<span class="w"> </span>Event<span class="w"> </span><span class="p">|</span><span class="w"> </span>Value
Event:<span class="w"> </span>.event.&lt;field&gt;
Value:<span class="w"> </span>number<span class="p">|</span>string
Operator:<span class="w"> </span>EQ<span class="p">|</span>LT<span class="p">|</span>LE<span class="p">|</span>GT<span class="p">|</span>GE<span class="p">|</span>STRCMP<span class="p">|</span>REGEX<span class="p">|</span>AND<span class="p">|</span>OR
</pre></div>
</div>
<p>Some simple examples are:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># always true</span>
<span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>EQ
<span class="c1"># always false</span>
<span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>EQ
<span class="c1"># true if event has payload equals to &#39;Hugo hat husten&#39;</span>
.event.payload<span class="w"> </span><span class="s1">&#39;Hugo hat husten&#39;</span><span class="w"> </span>STRCMP
<span class="c1"># true if payload contains ip from 192.168.7.1/24</span>
.event.payload<span class="w"> </span>r<span class="s1">&#39;192\.168\.7\.[0-9]{1,3}&#39;</span><span class="w"> </span>REGEX
</pre></div>
</div>
<section id="id2">
<h3>Syslog Scanner<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>The syslog scanner expects the following config structure:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>SyslogScanner
├──<span class="w"> </span>SyslogPath
└──<span class="w"> </span>MappingRules
<span class="w">    </span>├──<span class="w"> </span>MessageCode
<span class="w">    </span>│<span class="w">   </span>├──<span class="w"> </span><span class="m">4000</span>
<span class="w">    </span>│<span class="w">   </span>├──<span class="w"> </span><span class="m">4001</span>
<span class="w">    </span>│<span class="w">   </span>├──<span class="w"> </span><span class="m">2001</span>
<span class="w">    </span>│<span class="w">   </span>└──<span class="w"> </span>...<span class="w"> </span><span class="o">(</span>more<span class="w"> </span>MessageCodes<span class="o">)</span>
<span class="w">    </span>└──<span class="w"> </span>...<span class="w"> </span><span class="o">(</span>other<span class="w"> </span>event<span class="w"> </span>attributes<span class="w"> </span>like<span class="w"> </span>Severity,<span class="w"> </span>Classification,<span class="w"> </span>...<span class="o">)</span>
</pre></div>
</div>
<p>The MappingRules are provided through the configuration. The configuration (samconf) allows to lookup single options by a path like notation.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">4000</span>:<span class="w"> </span><span class="s2">&quot;.event.source.appName &#39;ssh&#39; STRCMP&quot;</span>
<span class="m">4001</span>:<span class="w"> </span><span class="s2">&quot;.event.severity 3 EQ&quot;</span>
</pre></div>
</div>
</section>
<section id="id3">
<h3>Kmsg Scanner<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>Reads the kernel log from <code class="docutils literal notranslate"><span class="pre">/dev/kmsg</span></code> or from a file pointed to by ELOS_KMSG_FILE environment variable. The file shall be created with mkfifo.</p>
</section>
</section>
<section id="event-ouputs-event-logging-backend-configuration">
<h2>[Event-Ouputs] Event Logging Backend Configuration<a class="headerlink" href="#event-ouputs-event-logging-backend-configuration" title="Link to this heading">¶</a></h2>
<p>Depending on the installation on the local system, it might be necessary to set
<code class="docutils literal notranslate"><span class="pre">ELOS_BACKEND_PATH</span></code> to the directory where the backend plugin libraries are installed.</p>
<section id="plugins">
<h3>Plugins<a class="headerlink" href="#plugins" title="Link to this heading">¶</a></h3>
<p>It is possible to create logger instances by configuring instance of logger plugins
in the elosd config file.
Using the json configuration as an example, defining an instance of a logger plugin
could look like the following:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;root&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;elos&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;EventLogging&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;PluginSearchPath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/usr/lib/x86_64-linux-gnu/elos/backend&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;Plugins&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;&lt;Instance Name&gt;&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nt">&quot;File&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;.so File(eg. backend_json.so)&gt;&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;Run&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;Always/Never&gt;&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;Filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;&lt;array of RPN-filters&gt;&quot;</span><span class="w"> </span><span class="p">],</span>
<span class="w">                        </span><span class="nt">&quot;Config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="nt">&quot;&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Map of Plugin specific configuration options&quot;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It is possible to use the same .so Files for multiple instances, with different names, filters and configurations.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;Plugins&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;JsonBackend&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="nt">&quot;File&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;backend_json.so&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="nt">&quot;Run&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Always&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="nt">&quot;Filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;1 1 EQ&quot;</span><span class="w"> </span><span class="p">],</span>
<span class="w">	</span><span class="nt">&quot;Config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="nt">&quot;StoragePath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/tmp/elosd.log&quot;</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Would configure a backend named “JsonBackend” using the json backend library.
Per configuration it would be started on elosd startup, and it would log all
incoming messages to /tmp/elosd.log. “StoragePath” is a json_backend.so specific
configuration, refer to its chapter for more detail.</p>
<p>Currently, only the <code class="docutils literal notranslate"><span class="pre">Run</span></code> options <code class="docutils literal notranslate"><span class="pre">Always</span></code> and <code class="docutils literal notranslate"><span class="pre">Never</span></code> are supported,
but in the future, other options could be included to allow for deferred startup
of a plugin instance, if necessary for other services like network interfaces,
for example.</p>
<section id="json-backend-plugin">
<h4>Json Backend Plugin<a class="headerlink" href="#json-backend-plugin" title="Link to this heading">¶</a></h4>
<p>This is changeable by either configuring the option “StoragePath” unter “Config”,
or by defining <code class="docutils literal notranslate"><span class="pre">ELOS_STORAGE_BACKEND_&lt;PLUGIN</span> <span class="pre">NAME&gt;_FILE</span></code> in the enviroment.
If defined the enviroment variable takes precedent over the file configuration.
The definition of “StoragePath” is mandatory, but it can be defined as empty,
in which case the default value, <code class="docutils literal notranslate"><span class="pre">/var/log/elosd.log</span></code> will be used.</p>
<p>Another, in its case optional, configuration option is “Flags”, which allows
to define additional flags with which the log file is opened. If specified,
its value is a json list of strings contaning all options that are additionally
wanted.
Currently the following list of flags are possible to be used:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">O_NOATIME</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">O_DIRECT</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">O_SYNC</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">O_DSYNC</span></code></p></li>
</ul>
<p>As long as the value is a valid json list, any unspecified or non-string option
will simply be ignored with a warning, instead of creating an error and exitting.</p>
<p>An example configuration of two coexisting json backend loggers using all options
could look as following:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;Plugins&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;RegularLog&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;File&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;backend_json.so&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Run&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Always&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;.messageCode 5005 NE&quot;</span><span class="w"> </span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;Config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;StoragePath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/tmp/elosd_%host%_%date%_%count%.log&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Flags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;O_DSYNC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;O_NOATIME&quot;</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;DateFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;%m-%d-%Y&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;PathSizeLimit&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">            </span><span class="nt">&quot;MaxSize&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100000</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;CoreDump&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;File&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;backend_json.so&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Run&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Always&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;.messageCode 5005 EQ&quot;</span><span class="w"> </span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;Config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;StoragePath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/tmp/coredump.log&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Flags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;O_SYNC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;O_DIRECT&quot;</span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This configures two loggers, one logging all non-coredump events to /tmp/elosd.log,
which is opened using the <code class="docutils literal notranslate"><span class="pre">O_DSYNC</span></code> and <code class="docutils literal notranslate"><span class="pre">O_NOATIME</span></code> options. The second
one logs all coredump events to /tmp/coredump.log using the <code class="docutils literal notranslate"><span class="pre">O_SYNC</span></code> and
<code class="docutils literal notranslate"><span class="pre">O_DIRECT</span></code> options.</p>
<p>The first logger additionally uses variables for its logs name, as well as log
rotation. The <code class="docutils literal notranslate"><span class="pre">%*%</span></code> macros get replaced by following values:</p>
<ul class="simple">
<li><p>host: the host machines name as registered by safu</p></li>
<li><p>date: the date of creation of the file</p></li>
<li><p>count: a counter numbering files with, besides the counter, exactly the same
filename.</p></li>
</ul>
<p>The DateFormat field, which the first logger has defined is an optional field
that defines the format of the date which replaces <code class="docutils literal notranslate"><span class="pre">%date%</span></code>. This formatting
uses the strftime function of time.h and the string and its conversion follows
strftimes conversion specifications. If DateFormat is not given, the used format
string is <code class="docutils literal notranslate"><span class="pre">%Y%m%d</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">%date%</span></code> is defined, date-based log rotation gets enabled.The log files
gets rotated whenever the formatted date string for the file changes. This
allows to configure a rotation every second, but also every year, depending on
the dates format string.</p>
<p>The MaxSize field defines an upper limit for a json loggers log file size.
When the file reaches the size limit, and <code class="docutils literal notranslate"><span class="pre">%count%</span></code> is defined,
the logfile will rotate. It is necessary to make this rotation dependend on
<code class="docutils literal notranslate"><span class="pre">%count%</span></code> to ensure the uniqueness of the new filename after the rotation.
If MaxSize is not set, it will default to a maximum size of 10000 bytes. This
default value can be overwritten by setting the define
<code class="docutils literal notranslate"><span class="pre">ELOS_JSON_LOGGER_MAX_FILE_SIZE</span></code> during compile time.</p>
<p>The PathSizeLimit field is another optional field, which limits the size of
the, macro resolved, file path. If the final file path exceeds the limit, the
logging file path will default to <code class="docutils literal notranslate"><span class="pre">/var/log/elosd.log</span></code>. This can be changed
by defining <code class="docutils literal notranslate"><span class="pre">STORAGE_LOCATION</span></code> at compile time.</p>
<p>If PathSizeLimit itself is not set, it will default to 1024. This value can be
changed by defining <code class="docutils literal notranslate"><span class="pre">ELOS_JSON_LOGGING_PATH_LIMIT_DEFAULT</span></code> at compile time.</p>
</section>
<section id="sql-backend-plugin">
<h4>SQL Backend Plugin<a class="headerlink" href="#sql-backend-plugin" title="Link to this heading">¶</a></h4>
<p>The SQL Backend Plugin implements a logging backend using sqlite3.
The code for it is an unofficial Proof-of-Concept implementation that might be
changed or removed at any moment without prior notice.</p>
<p>Configuration for it is similar to other plugins and look as follows:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;&lt;Instance Name&gt;&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;File&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;backend_sql.so&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Run&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;always/never&gt;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;ConnectionPath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Connection Path configures the path to the storage database file for sqlite3.
The option is optional. If the option is omitted, instead the value of the the
enviroment variable <code class="docutils literal notranslate"><span class="pre">ELOS_STORAGE_BACKEND_SQL_CONNECTION</span></code>is used. If the
variable is not set, the default value <code class="docutils literal notranslate"><span class="pre">/var/db/elosd.sqlite</span></code> will be used.</p>
</section>
</section>
</section>
<section id="elosc-as-demo-application-to-verify">
<h2>Elosc as demo application to verify<a class="headerlink" href="#elosc-as-demo-application-to-verify" title="Link to this heading">¶</a></h2>
<p>Using the elos client (elosc), it is possible to interact with the running EventProcessor (elosd).
The following options are available:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>-s<span class="w"> </span>&lt;filter<span class="w"> </span>rule&gt;<span class="w">	</span>subscribe<span class="w"> </span>to<span class="w"> </span>event<span class="w">	</span>Subscribe<span class="w"> </span>to<span class="w"> </span>events<span class="w"> </span>matching<span class="w"> </span>the<span class="w"> </span>given<span class="w"> </span>filter<span class="w"> </span>rule.
-f<span class="w"> </span>&lt;filter<span class="w"> </span>rule&gt;<span class="w">	</span>search<span class="w"> </span><span class="k">for</span><span class="w"> </span>event<span class="w">	</span>List<span class="w"> </span>all<span class="w"> </span>events<span class="w"> </span>matching<span class="w"> </span>the<span class="w"> </span>given<span class="w"> </span>filter<span class="w"> </span>rule
-p<span class="w"> </span>&lt;event&gt;<span class="w">		</span>push<span class="w"> </span>events<span class="w">		</span>create<span class="w"> </span>elos<span class="w"> </span>events<span class="w"> </span>using<span class="w"> </span>the<span class="w"> </span>canonical<span class="w"> </span>form<span class="w"> </span>and<span class="w"> </span>push<span class="w"> </span>the<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>elosd
-c<span class="w"> </span>n<span class="w">			</span><span class="nb">set</span><span class="w"> </span>count<span class="w">		</span><span class="nb">set</span><span class="w"> </span>maximum<span class="w"> </span>amount<span class="w"> </span>of<span class="w"> </span>shown<span class="w"> </span>results
-r<span class="w"> </span>n<span class="w">			</span><span class="nb">set</span><span class="w"> </span>rate<span class="w">		</span><span class="nb">set</span><span class="w"> </span>rate<span class="w"> </span>with<span class="w"> </span>which<span class="w"> </span>events<span class="w"> </span>are<span class="w"> </span>received<span class="w"> </span>or<span class="w"> </span>pushed<span class="w"> </span>at
-v<span class="w">			</span>show<span class="w"> </span>version
</pre></div>
</div>
<p>Refer back to [elosd Start and Test](## elosd Start and Test) for some basic examples.
For a more comprehensive view, look at the following examples:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>elosc<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;1 1 EQ&quot;</span><span class="w"> </span><span class="c1"># Subscribe to all</span>
elosc<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;.event.messageCode 42 EQ&quot;</span><span class="w"> </span><span class="c1"># Subscribe to all events with messageCode 42</span>

<span class="c1"># To search the event log (historical events):</span>
elosc<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;1 1 EQ&quot;</span><span class="w"> </span><span class="c1"># find all events</span>
elosc<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;.event.messageCode 42 EQ&quot;</span><span class="w"> </span><span class="c1"># find all events with messageCode 42</span>

<span class="c1"># find all events with messageCode between 400 and 500</span>
elosc<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;.event.messageCode 400 GE .event.messageCode 500 LE AND&quot;</span>
elosc<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;.event.payload &#39;Hugo&#39; STRCMP .event.messageCode 43 EQ AND&quot;</span>

<span class="c1"># Find all successful ssh logins</span>
elosc<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;.event.source.appName &#39;sshd&#39; STRCMP .event.payload r&#39;Accept&#39; REGEX AND&quot;</span>

<span class="c1"># To publish events:</span>
elosc<span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;{&quot;messageCode&quot;: 101, &quot;severity&quot;:42, &quot;payload&quot;:&quot;ping&quot;, &quot;source&quot;: {&quot;appName&quot;: &quot;elos_fs_test&quot;}}&#39;</span>
elsoc<span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;{}&#39;</span><span class="w"> </span><span class="c1"># will result in an event with only the date set</span>

<span class="c1"># send an event 10 times as fast as possible</span>
elosc<span class="w"> </span>-c<span class="w"> </span><span class="m">10</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;{&quot;messageCode&quot;: 101, &quot;severity&quot;:42, &quot;payload&quot;:&quot;ping&quot;, &quot;source&quot;: {&quot;appName&quot;: &quot;elos_fs_test&quot;}}&#39;</span>

<span class="c1"># send an event 100 times with a rate of 10Hz</span>
elosc<span class="w"> </span>-c<span class="w"> </span><span class="m">100</span><span class="w"> </span>-r<span class="w"> </span><span class="m">10</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;{&quot;messageCode&quot;: 101, &quot;severity&quot;:42, &quot;payload&quot;:&quot;ping&quot;, &quot;source&quot;: {&quot;appName&quot;: &quot;elos_fs_test&quot;}}&#39;</span>
</pre></div>
</div>
</section>
<section id="elosmon-demo-client">
<h2>elosMon demo client<a class="headerlink" href="#elosmon-demo-client" title="Link to this heading">¶</a></h2>
<p>Another example is the included demo client elosMon, which enables the user to subscribe for certain events with the elos daemon and get notified if these events occur. This can be used to keep track of coredumps in testing environments or to get notified on suspicious logins:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get notified on logins from a specific network</span>
<span class="n">elosMon</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">H</span> <span class="n">mailer</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> \
    <span class="o">-</span><span class="n">s</span> <span class="n">noreply</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span> \
    <span class="o">-</span><span class="n">f</span> <span class="s2">&quot;.event.source.appName &#39;login&#39; STRCMP .event.payload r&#39;192\.168\.3\.[0-9]{1,3}&#39; REGEX&quot;</span> \
    <span class="o">-</span><span class="n">r</span> <span class="n">mail</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span>

<span class="c1"># Get notified of coredumps</span>
<span class="n">elosMon</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">H</span> <span class="n">mailer</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="mi">25</span> \
    <span class="o">-</span><span class="n">s</span> <span class="n">noreply</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span> \
    <span class="o">-</span><span class="n">f</span> <span class="s2">&quot;.event.messageCode 5005 EQ&quot;</span> \
    <span class="o">-</span><span class="n">r</span> <span class="n">recipient1</span><span class="nd">@mail</span><span class="o">.</span><span class="n">com</span> \
    <span class="o">-</span><span class="n">r</span> <span class="n">recipient2</span><span class="nd">@mail</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
</section>
<section id="creating-an-elos-client">
<h2>Creating an elos client:<a class="headerlink" href="#creating-an-elos-client" title="Link to this heading">¶</a></h2>
<section id="using-libelos-explain-elos-demos">
<h3>using libelos - explain elos/demos<a class="headerlink" href="#using-libelos-explain-elos-demos" title="Link to this heading">¶</a></h3>
<p>To create an elos event using the c language:</p>
<ul class="simple">
<li><p>include the header</p></li>
<li><p>create the variables</p></li>
<li><p>connect to elos</p></li>
<li><p>create the event</p></li>
<li><p>fill the event</p></li>
<li><p>push the event</p></li>
<li><p>run session</p></li>
</ul>
<p>Finish the session with closing the connection</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;elos/libelos/libelos.h&quot;</span>

<span class="n">elosSession_t</span><span class="w"> </span><span class="o">*</span><span class="n">session</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<span class="kt">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="n">eventids</span><span class="p">;</span>
<span class="n">elosEvent_t</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="n">safuResultE_t</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="n">elosEventVector_t</span><span class="w"> </span><span class="o">*</span><span class="n">eventVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>

<span class="n">elosEvent</span><span class="w"> </span><span class="o">*</span><span class="n">event</span><span class="p">;</span>
<span class="n">elosEvent</span><span class="w"> </span><span class="n">publishEvent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="p">.</span><span class="n">hardwareid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;abc&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">severity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ELOS_SEVERITY_ERROR</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;some payload&quot;</span>
<span class="p">};</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argcm</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">elosEventQueueId_t</span><span class="w"> </span><span class="n">eventQueueId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ELOS_ID_INVALID</span><span class="p">;</span>

<span class="w">    </span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elosConnectTcpip</span><span class="p">(</span><span class="s">&quot;127.0.0.1&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">54321</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">session</span><span class="p">);</span>

<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elosEventSubscribe</span><span class="p">(</span><span class="n">session</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;.event.source.appName &#39;ssh&#39; STRCMP&quot;</span><span class="p">},</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">eventQueueId</span><span class="p">);</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elosEventPublish</span><span class="p">(</span><span class="n">session</span><span class="p">,</span><span class="o">&amp;</span><span class="n">publishEvent</span><span class="p">);</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elosEventQueueRead</span><span class="p">(</span><span class="n">session</span><span class="p">,</span><span class="w"> </span><span class="n">eventQueueId</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">eventVector</span><span class="p">);</span>
<span class="w">    </span><span class="n">event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">safuVecGetLast</span><span class="p">(</span><span class="n">eventVector</span><span class="p">);</span>

<span class="w">    </span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elosDisconnect</span><span class="p">(</span><span class="n">session</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Using an existing Event from the previous example, create, monitor and remove eventlists</p>
</section>
<section id="interacting-with-elos-through-tcp-ip-client">
<h3>Interacting with elos through tcp/ip client.<a class="headerlink" href="#interacting-with-elos-through-tcp-ip-client" title="Link to this heading">¶</a></h3>
<p>A tcp client can interact with with a running instance of elos. In the following example
a direct connection to elos from tcp client written in python is shown.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">socket</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s2">&quot;&lt;elos ip&gt;&quot;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">elos</span> <span class="n">port</span><span class="o">&gt;</span><span class="p">))</span>
<span class="n">client</span><span class="o">.</span><span class="n">diconnect</span><span class="p">()</span>
</pre></div>
</div>
<p>The elos ip should be the ip adrress of the target where an instance of elos is running and
the elos port is the port set in elos configuration.</p>
<p>In order to send commands and receive responses from elos, the commands
need to follow the elos protocol. The elos message protocol for interaction via tcp
client is:</p>
<ul class="simple">
<li><p>an 8 bit unsinged integer encoding the version of the elos protocol</p></li>
<li><p>an 8 bit unsinged integer encoding the command</p></li>
<li><p>an 16 bit unsinged integer encoding the length of the actual message</p></li>
<li><p>an char array, with length as stated in the previouse integer, containing the actual message.</p></li>
</ul>
<p>The current elos protocol version is 0x01. The commands encoded with an 8-bit unsinged integer are:</p>
<ul class="simple">
<li><p>Invalid Message: 0x00</p></li>
<li><p>Get Protocl Version: 0x01</p></li>
<li><p>EventPublish: 0x02</p></li>
<li><p>EventSubscribe: 0x03</p></li>
<li><p>FindEvent: 0x04</p></li>
<li><p>EventQueueRead: 0x05</p></li>
</ul>
<p>The corresponding reponses are :</p>
<ul class="simple">
<li><p>Response Invalid Message: 0x80</p></li>
<li><p>Response Get Protocol Version: 0x81</p></li>
<li><p>ResponseEventPublish: 0x82</p></li>
<li><p>ResponseEventSubscribe: 0x83</p></li>
<li><p>ResponseFindEvent: 0x84</p></li>
<li><p>ResponseEventQueueRead: 0x85</p></li>
</ul>
<p>The length of the actual is inclusive of the null termination byte at the end of the string. The
Message shall be a json formatted string. An example of the above protocol written in python is
given below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">struct</span>

<span class="n">version</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">messagecode</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">messagestring</span> <span class="o">=</span> <span class="s1">&#39;{&quot;messageCode&quot;: 4,&quot;payload&quot;:&quot;testEventFiltering&quot;}&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">messagestring</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\0</span><span class="s1">&#39;</span>
<span class="n">packet</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&lt;bbh&quot;</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">messagecode</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="o">+</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>In the python script the individual elements are packed together in to a byte array
using the the script module. More about the module can be found here (https://docs.python.org/3/library/struct.html).</p>
<p>Further example of messages are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">messagestring</span> <span class="o">=</span> <span class="s1">&#39;{&quot;messageCode&quot;: 4,&quot;payload&quot;:&quot;testEventFiltering&quot;}&#39;</span>
<span class="n">messagestring</span> <span class="o">=</span> <span class="s1">&#39;{&quot;filter&quot;:&quot;.event.messageCode 4 EQ&quot;}&#39;</span>
<span class="n">messagestring</span> <span class="o">=</span> <span class="s1">&#39;{&quot;filter&quot;:&quot;.event.messageCode 4 EQ .event.payload &#39;</span><span class="n">testEventFiltering</span><span class="s1">&#39; STRCMP AND&quot;}&#39;</span>
</pre></div>
</div>
<p>The communication with the elosd is then request/response oriented, where a request is sent and then
listen for the corresponding response command. An example  written in python is given below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">struct</span>

<span class="n">version</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># send a message to be published in elos</span>
<span class="n">publish_code</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">messagestring</span> <span class="o">=</span> <span class="s1">&#39;{&quot;messageCode&quot;: 41,&quot;payload&quot;:&quot;testEventFiltering&quot;}&#39;</span>

<span class="c1"># send a query to retrieve a published message</span>
<span class="n">query_code</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">querystring</span> <span class="o">=</span> <span class="s1">&#39;{&quot;filter&quot;:&quot;.event.messageCode 8000 EQ&quot;}&#39;</span>

<span class="c1">#connect to elos</span>
<span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;172.17.0.2&quot;</span><span class="p">,</span> <span class="mi">54321</span><span class="p">)</span>

<span class="c1"># pack message to be published to byte array according to elos protocol</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">messagestring</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\0</span><span class="s1">&#39;</span>
<span class="n">packet</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&lt;bbh&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">version</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">publish_code</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="o">+</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># send to target</span>
<span class="n">client</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span>

<span class="c1"># reponse to sent message</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="n">rversion</span><span class="p">,</span> <span class="n">rmessagecode</span><span class="p">,</span> <span class="n">rlen</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&lt;bbh&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

<span class="c1"># extracted response message</span>
<span class="n">received_message</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">rlen</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># pack a query message into byte array according to elos protocol</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">querystring</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\0</span><span class="s1">&#39;</span>
<span class="n">packet</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&lt;bbh&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">version</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">query_code</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="o">+</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">client</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span>

<span class="c1"># reponse to sent message</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="n">rversion</span><span class="p">,</span> <span class="n">rmessagecode</span><span class="p">,</span> <span class="n">rlen</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&lt;bbh&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

<span class="c1"># extracted response message</span>
<span class="n">received_message</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">rlen</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/elos_blue.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">elos</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Users</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#short-overview">Short Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#events">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="#logging">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#communication">Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filters">Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scanner">Scanner</a></li>
<li class="toctree-l2"><a class="reference internal" href="#elos-tools">Elos-Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="#elosd-installation-setup">elosd - Installation &amp; Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#elosd-configuration-options-explained">elosd Configuration - Options Explained</a></li>
<li class="toctree-l2"><a class="reference internal" href="#elosd-start-and-test">elosd Start and Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#event-inputs-scanner-setup">[Event-Inputs] Scanner Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#event-ouputs-event-logging-backend-configuration">[Event-Ouputs] Event Logging Backend Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#elosc-as-demo-application-to-verify">Elosc as demo application to verify</a></li>
<li class="toctree-l2"><a class="reference internal" href="#elosmon-demo-client">elosMon demo client</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-an-elos-client">Creating an elos client:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../src/demos/index.html">Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build/Debug/doc/source_generated/api/index.html">public API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src/index.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build/Debug/doc/source_generated/developer/api/index.html">Complete API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Architecture_Design_Records/index.html">ADRs</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">How we document</a></li>
<li class="toctree-l1"><a class="reference internal" href="../test/index.html">Verification Strategy or how we test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../.github/index.html">GitHub CI</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../index.html" title="previous chapter">Welcome to elos’s documentation!</a></li>
      <li>Next: <a href="../src/demos/index.html" title="next chapter">Demos</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, wolfgang.gehrhardt@emlix.com.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/doc/userManual.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>